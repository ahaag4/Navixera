<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Professional e-commerce website with responsive design and advanced features">
    <meta name="keywords" content="e-commerce, responsive, professional, shopping">
    <title>ProShop - Responsive E-Commerce</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        * { box-sizing: border-box; }
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; line-height: 1.6; }
        .navbar { background-color: #333; }
        .navbar-brand, .nav-link { color: white !important; }
        .search-bar { width: 100%; margin-bottom: 10px; }
        .filter-section { margin: 10px 0; }
        .product-card { margin: 10px 0; border: 1px solid #ddd; padding: 10px; }
        .product-card img { max-width: 100%; height: auto; }
        .review { margin: 10px 0; }
        .dashboard { display: none; }
        .chat-widget { position: fixed; bottom: 20px; right: 20px; width: 300px; height: 400px; border: 1px solid #ccc; background: white; display: none; }
        @media (min-width: 768px) {
            .search-bar { width: 50%; }
            .product-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
            .dashboard { display: block; }
        }
        @media (min-width: 1200px) {
            .product-grid { grid-template-columns: repeat(4, 1fr); }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">ProShop</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="#home">Home</a></li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="categoryDropdown" role="button" data-bs-toggle="dropdown">Categories</a>
                        <ul class="dropdown-menu" aria-labelledby="categoryDropdown">
                            <li><a class="dropdown-item" href="#">Electronics</a></li>
                            <li><a class="dropdown-item" href="#">Clothing</a></li>
                            <li><a class="dropdown-item" href="#">Books</a></li>
                        </ul>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="#cart">Cart</a></li>
                    <li class="nav-item"><a class="nav-link" href="#account">Account</a></li>
                </ul>
                <form class="d-flex ms-auto search-bar">
                    <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
                    <button class="btn btn-outline-light" type="submit">Search</button>
                </form>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">
        <!-- Filter Section -->
        <div class="filter-section">
            <select class="form-select" id="categoryFilter">
                <option value="">All Categories</option>
                <option value="electronics">Electronics</option>
                <option value="clothing">Clothing</option>
                <option value="books">Books</option>
            </select>
            <input type="number" class="form-control mt-2" id="priceFilter" placeholder="Max Price">
            <button class="btn btn-primary mt-2" id="applyFilter">Apply Filter</button>
        </div>

        <!-- Product Grid -->
        <div class="product-grid" id="productGrid"></div>

        <!-- Product Modal -->
        <div class="modal fade" id="productModal" tabindex="-1" aria-labelledby="productModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="productModalLabel">Product Details</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <img id="modalImage" src="" alt="Product Image" class="img-fluid mb-3">
                        <video id="modalVideo" controls style="display:none; width: 100%;"></video>
                        <p><strong>Description:</strong> <span id="modalDescription"></span></p>
                        <p><strong>Price:</strong> $<span id="modalPrice"></span></p>
                        <p><strong>Stock:</strong> <span id="modalStock"></span></p>
                        <a id="modalPDF" href="#" download>Download PDF</a>
                        <div id="modalReviews"></div>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button class="btn btn-primary" id="addToCartBtn">Add to Cart</button>
                        <button class="btn btn-success" id="buyNowBtn">Buy Now</button>
                        <button class="btn btn-info" id="requestQuoteBtn">Request Quote</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cart -->
        <div id="cart" class="mt-4">
            <h2>Shopping Cart</h2>
            <ul id="cartItems"></ul>
            <button class="btn btn-primary mt-2" id="checkoutBtn">Checkout</button>
        </div>

        <!-- Account Section -->
        <div id="account" class="mt-4">
            <h2>Account</h2>
            <p>Welcome, <span id="userEmail"></span>! <button class="btn btn-danger" id="logoutBtn">Logout</button></p>
            <div id="orderHistory"></div>
            <div id="dashboard" class="mt-4">
                <h3>Inventory Dashboard</h3>
                <ul id="inventoryList"></ul>
            </div>
        </div>

        <!-- Live Chat -->
        <div class="chat-widget" id="chatWidget">
            <h4>Live Support</h4>
            <div id="chatMessages"></div>
            <input type="text" id="chatInput" placeholder="Type a message...">
            <button id="sendMessage">Send</button>
        </div>
    </div>

    <!-- Bootstrap JS and Custom JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-database.js"></script>
    <script src="https://js.stripe.com/v3/"></script>
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCn9YSO4-ksWl6JBqIcEEuLx2EJN8jMj4M",
            authDomain: "svms-c0232.firebaseapp.com",
            databaseURL: "https://svms-c0232-default-rtdb.firebaseio.com",
            projectId: "svms-c0232",
            storageBucket: "svms-c0232.appspot.com",
            messagingSenderId: "359201898609",
            appId: "1:359201898609:web:893ef076207abb06471bd0"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();
        const stripe = Stripe('pk_test_51J3fG2I8k3z9e4rX0q0s6xX8'); // Replace with your Stripe key

        // State Management
        let user = null;
        let cart = [];
        let products = [];

        // Load Products
        function loadProducts() {
            db.ref('products').on('value', (snapshot) => {
                products = snapshot.val() || [];
                renderProducts();
            });
        }

        // Render Products
        function renderProducts() {
            const productGrid = document.getElementById('productGrid');
            productGrid.innerHTML = '';
            const categoryFilter = document.getElementById('categoryFilter').value;
            const priceFilter = parseFloat(document.getElementById('priceFilter').value) || Infinity;

            products.filter(p => 
                (!categoryFilter || p.category === categoryFilter) && 
                (p.price <= priceFilter)
            ).forEach(product => {
                const card = document.createElement('div');
                card.className = 'product-card';
                card.innerHTML = `
                    <img src="${product.image}" alt="${product.name}" loading="lazy">
                    <h4>${product.name}</h4>
                    <p>$${product.price}</p>
                    <button class="btn btn-primary" onclick="showProductModal('${product.id}')">View Details</button>
                `;
                productGrid.appendChild(card);
            });
        }

        // Product Modal
        function showProductModal(productId) {
            const product = products.find(p => p.id === productId);
            document.getElementById('modalImage').src = product.image;
            document.getElementById('modalImage').style.display = product.image ? 'block' : 'none';
            document.getElementById('modalVideo').src = product.video || '';
            document.getElementById('modalVideo').style.display = product.video ? 'block' : 'none';
            document.getElementById('modalDescription').textContent = product.description;
            document.getElementById('modalPrice').textContent = product.price;
            document.getElementById('modalStock').textContent = product.stock;
            document.getElementById('modalPDF').href = product.pdf || '#';
            document.getElementById('modalPDF').style.display = product.pdf ? 'block' : 'none';
            document.getElementById('modalReviews').innerHTML = product.reviews?.map(r => `<div class="review">${r.text} <span>⭐${r.rating}</span></div>`).join('') || 'No reviews yet';
            document.getElementById('addToCartBtn').onclick = () => addToCart(productId);
            document.getElementById('buyNowBtn').onclick = () => checkout([productId]);
            document.getElementById('requestQuoteBtn').onclick = () => requestQuote(productId);
            new bootstrap.Modal(document.getElementById('productModal')).show();
        }

        // Cart Management
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            cart.push(product);
            renderCart();
            alert(`${product.name} added to cart!`);
        }

        function renderCart() {
            const cartItems = document.getElementById('cartItems');
            cartItems.innerHTML = cart.map(p => `<li>${p.name} - $${p.price} <button onclick="removeFromCart('${p.id}')">Remove</button></li>`).join('');
        }

        function removeFromCart(productId) {
            cart = cart.filter(p => p.id !== productId);
            renderCart();
        }

        // Checkout
        function checkout(productIds) {
            if (!user) return alert('Please log in');
            const total = productIds.reduce((sum, id) => sum + (products.find(p => p.id === id)?.price || 0), 0);
            if (confirm(`Total: $${total}. Proceed to payment?`)) {
                // Simulate Stripe payment
                stripe.createPaymentIntent({ amount: total * 100, currency: 'usd' })
                    .then(result => {
                        if (result.error) alert(result.error.message);
                        else {
                            db.ref(`users/${user.uid}/orders`).push({ products: productIds, total, date: new Date().toISOString() });
                            cart = [];
                            renderCart();
                            alert('Payment successful!');
                        }
                    });
                // Simulate UPI payment
                const upiLink = `upi://pay?pa=test@upi&am=${total}&cu=INR&tn=ProShop Purchase`;
                window.open(upiLink, '_blank');
            }
        }

        // Request Quote
        function requestQuote(productId) {
            if (!user) return alert('Please log in');
            const quantity = prompt('Enter quantity for quote:');
            if (quantity) {
                db.ref(`users/${user.uid}/quotes`).push({ productId, quantity, date: new Date().toISOString() });
                alert('Quote request submitted!');
            }
        }

        // Bulk Order
        document.getElementById('checkoutBtn').addEventListener('click', () => {
            if (cart.length) checkout(cart.map(p => p.id));
            else alert('Cart is empty!');
        });

        // Authentication
        auth.onAuthStateChanged((u) => {
            user = u;
            document.getElementById('userEmail').textContent = user?.email || 'Guest';
            document.getElementById('orderHistory').innerHTML = user ? '<h4>Order History</h4>' + (Object.values(db.ref(`users/${user.uid}/orders`).val() || {}).map(o => `<p>Order #${o.date}: $${o.total}</p>`).join('')) : '';
            document.getElementById('dashboard').style.display = user && user.email === 'admin@proshop.com' ? 'block' : 'none';
            loadInventory();
        });

        document.getElementById('logoutBtn').addEventListener('click', () => auth.signOut());

        // Inventory Dashboard
        function loadInventory() {
            if (user && user.email === 'admin@proshop.com') {
                db.ref('products').on('value', (snapshot) => {
                    const inventory = snapshot.val() || [];
                    document.getElementById('inventoryList').innerHTML = inventory.map(p => `<li>${p.name} - Stock: ${p.stock}</li>`).join('');
                });
            }
        }

        // Filters
        document.getElementById('applyFilter').addEventListener('click', renderProducts);

        // Live Chat
        document.getElementById('chatWidget').style.display = 'block';
        document.getElementById('sendMessage').addEventListener('click', () => {
            const message = document.getElementById('chatInput').value;
            if (message && user) {
                db.ref('chat').push({ userId: user.uid, message, time: new Date().toISOString() });
                document.getElementById('chatInput').value = '';
            }
        });
        db.ref('chat').on('value', (snapshot) => {
            const messages = snapshot.val() || {};
            document.getElementById('chatMessages').innerHTML = Object.values(messages).map(m => `<p>${m.userId}: ${m.message} (${m.time})</p>`).join('');
        });

        // Analytics (Simulated)
        setInterval(() => {
            console.log('Analytics: Total Views:', Math.floor(Math.random() * 1000));
        }, 60000);

        // Integration Points (Simulated)
        function integrateWithCRM() {
            console.log('Integrating with CRM...');
            // Placeholder for actual CRM integration (e.g., Salesforce API)
        }

        // Initial Load
        loadProducts();
    </script>
</body>
</html>
